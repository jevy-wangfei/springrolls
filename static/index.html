<!DOCTYPE html>
<!--
  Copyright (c) 2016
  Single page web based app
-->
<html>
  <head>
    <meta charset="utf-8">
    <title>Spring Rolls</title>
    <link rel="stylesheet" href="./css/bootstrap.min.css" media="screen" charset="utf-8">
    <link rel="stylesheet" href="./css/main.css" media="screen"  charset="utf-8">
    <link href="./font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  </head>
  <body>
    <nav class="navbar navbar-default">
      <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html"><img src="./img/logo.png" style="height:35px" alt="" /></a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav">
            <li class="active"><a href="index.html">Recipes &#38; Restaurant<span class="sr-only">(current)</span></a></li>
            <li><a href="creativity.html">Creativity &#38; Fastival</a></li>
            <li><a href="#">Favorite</a></li>
          </ul>
          <form class="navbar-form navbar-left">
            <div class="form-group">
              <input type="text" class="form-control" placeholder="Search Recipy or Creativity ...">
            </div>
            <button type="submit" class="btn btn-default">Search</button>
          </form>
          <ul class="nav navbar-nav navbar-right">
            <li><a href="#">Login</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><i class="fa fa-cog" aria-hidden="true"></i> <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="#">Account</a></li>
                <li><a href="#">My Recipes</a></li>
                <li role="separator" class="divider"></li>
                <li><a href="#">Logout</a></li>
              </ul>
            </li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>

    <div class="container">
      <div class="row">
        <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
          <!-- Indicators -->
          <ol class="carousel-indicators">
            <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
            <li data-target="#carousel-example-generic" data-slide-to="1"></li>
            <li data-target="#carousel-example-generic" data-slide-to="2"></li>
          </ol>

          <!-- Wrapper for slides -->
          <div class="carousel-inner" role="listbox">
          <div class="item active">
            <img src="./img/index1.jpeg" style="width:100%" alt="...">
            <div class="carousel-caption">
              ...
            </div>
          </div>
          <div class="item">
            <img src="./img/index2.jpeg" style="width:100%" alt="...">
            <div class="carousel-caption">
              ...
            </div>
          </div>
          <div class="item">
            <img src="./img/index3.jpeg" style="width:100%" alt="...">
            <div class="carousel-caption">
              ...
            </div>
          </div>

          </div>

          <!-- Controls -->
          <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
          <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
          </a>
          <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
          <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
          </a>
        </div>
        <!-- <div class="col-xs-2" id="left-menu">
          <div class="panel panel-cust">
            <div class="panel-heading">
              <i class="pannel-title">View By Type</i>
            </div>
            <div class="panel-body">
              <ul class="type-view">
                <li>Recipy</li>
                <li>Creativity</li>
                <li>Favorite</li>
              </ul>
            </div>
          </div>

          <div class="panel panel-cust">
            <div class="panel-heading">
              <i class="pannel-title">Tags</i>
            </div>
            <div class="panel-body views" id="top-tags">
              <a href="#"><span class="label label-default">Chinese</span></a>
              <a href="#"><span class="label label-primary">Fresh</span></a>
              <a href="#"><span class="label label-success">Indian</span></a>
              <a href="#"><span class="label label-info">Fruit</span></a>
              <a href="#"><span class="label label-warning">Vegetarian</span></a>
              <a href="#"><span class="label label-danger">Specipy</span></a>
            </div>
          </div>
        </div> -->
        <!-- Notes Display and new notes-->


        <div class="col-xs-12 gallery">
          <!-- <ol class="breadcrumb alert alert-warning" >
            <li><h4>Recipes and Creativities</h4></li>
          </ol> -->

          <div id="gallery">
            <!-- Images display here -->
            <div class="panel panel-default panel-cust">
              <div class="panel-heading">
                <i class="pannel-title">Cooking Chinese Food... Have a TRY!!! <label class="label label-primary">Creativity</label></i>
                <i class="pull-right">06:00pm, Oct 10, 2016 at Fortun Box Chinese Restaurant</i>
                <div class="clearfix"></div>
              </div>
              <div class="panel-body">
                <div class="col-xs-6 cust-shumbnail">
                  <a href="./creativity.html" class="thumbnail">
                    <div class="media">
                      <div class="media-left col-xs-6">
                        <img class="media-object col-xs-12" src="./img/test1.jpg" alt="...">
                      </div>
                      <div class="media-body col-xs-6">
                        <h4 class="media-heading">Creativity Title</h4>
                        <p>
                          This event will be hold at XXX, open time 6:00pm Oct 10, 2016, and colse at 9:00pm Oct 10.
                        </p>
                        <p>
                            <i>06/06/2016</i>
                        </p>
                      </div>
                    </div>
                  </a>
                </div>
                <div class="col-xs-6 cust-shumbnail">
                  <a href="#" class="thumbnail">
                    <div class="media">
                      <div class="media-left col-xs-6">
                        <img class="media-object col-xs-12" src="./img/test1.jpg" alt="...">
                      </div>
                      <div class="media-body col-xs-6">
                        <h4 class="media-heading">Creativity Title</h4>
                        <p>
                          This event will be hold at XXX, open time 6:00pm Oct 10, 2016, and colse at 9:00pm Oct 10.
                        </p>
                        <p>
                            <i>06/06/2016</i>
                        </p>
                      </div>
                    </div>
                  </a>
                </div>
              </div>
            </div>


            <div class="panel panel-default panel-cust ">
              <div class="panel-heading">
                <i class="pannel-title">Jevy's new Recipy <label class="label label-default">Recipy</label></i>
                <i class="pull-right">06:00pm, Oct 10, 2016 at Fortun Box Chinese Restaurant</i>
                <div class="clearfix"></div>
              </div>
              <div class="panel-body">
                <div class="col-xs-6 cust-shumbnail">
                  <a href="#" class="thumbnail">
                    <div class="media">
                      <div class="media-left col-xs-6">
                        <img class="media-object col-xs-12" src="./img/test1.jpg" alt="...">
                      </div>
                      <div class="media-body col-xs-6">
                        <h4 class="media-heading">Creativity Title</h4>
                        <p>
                          This event will be hold at XXX, open time 6:00pm Oct 10, 2016, and colse at 9:00pm Oct 10.
                        </p>
                        <p>
                            <i>06/06/2016</i>
                        </p>
                      </div>
                    </div>
                  </a>
                </div>
                <div class="col-xs-6 cust-shumbnail">
                  <a href="#" class="thumbnail">
                    <div class="media">
                      <div class="media-left col-xs-6">
                        <img class="media-object col-xs-12" src="./img/test1.jpg" alt="...">
                      </div>
                      <div class="media-body col-xs-6">
                        <h4 class="media-heading">Creativity Title</h4>
                        <p>
                          This event will be hold at XXX, open time 6:00pm Oct 10, 2016, and colse at 9:00pm Oct 10.
                        </p>
                        <p>
                            <i>06/06/2016</i>
                        </p>
                      </div>
                    </div>
                  </a>
                </div>
              </div>
            </div>

          </div>
        </div>

        <div class="footer col-xs-12">
          <div class="col-xs-10">
              Powered By: Bootstrap, JQuery, JavaScript, PHP
          </div>
          <div class="col-xs-2">
            Author
          </div>
        </div>
      </div> <!-- End of Row -->
    </div> <!-- End of Container -->
    <div class="media-button">
      <ul class="list-inline">
        <li><a href="#" class="icoRss" title="Rss"><i class="fa fa-rss"></i></a></li>
        <li><a href="#" class="icoFacebook" title="Facebook"><i class="fa fa-facebook"></i></a></li>
        <li><a href="#" class="icoTwitter" title="Twitter"><i class="fa fa-twitter"></i></a></li>
        <li><a href="#" class="icoGoogle" title="Google +"><i class="fa fa-google-plus"></i></a></li>
        <li><a href="#" class="icoLinkedin" title="Linkedin"><i class="fa fa-linkedin"></i></a></li>
      </ul>
    </div>
  </body>
  <script src="./js/jquery.min.js" charset="utf-8"></script>
  <script src="./js/bootstrap.min.js" charset="utf-8"></script>
  <script src="./js/ajax-custom.js" charset="utf-8"></script>
  <script type="text/javascript">
  //Auto execute Function: Loading and appending all elements on UI
  $(document).ready(function(){
    // loadImages();
    // loadNames();
    // loadTags();
    // loadTopNames();
    // loadTopTags();
    // $("#tag-view").hide();
    // $("#name-view").hide();
    // viewListener();
  });


// // Filters
// $(document).ready(function(){
//   $("#invert").on('click', function () {
//     $("#singleView").find("img").removeClass();
//     $("#singleView").find("img").addClass("invert");
//   });
//   $("#sepia").on('click', function () {
//     $("#singleView").find("img").removeClass();
//     $("#singleView").find("img").addClass("sepia");
//   });
//   $("#greyscale").on('click', function () {
//     $("#singleView").find("img").removeClass();
//     $("#singleView").find("img").addClass("greyscale");
//   });
//   $("#default").on('click', function () {
//     $("#singleView").find("img").removeClass();
//   });
// });

// Load recent 10 images order by uploaded time
$(document).ready(function(){
  // console.log($("#gallery"));
  $("#recently").on('click', function() {
    restGet(HOST+"/recently", GET_METHOD, function(data){
      $("#gallery").empty();
      $.each(data, function(index,row) {
        // console.log(row);
        var tag = (row.tag).replace(' ', '-')
        var username = (row.username).replace(' ', '-')
        var newImage = $('<div class="col-xs-4 '+tag +' '+username+'" data-iid='+row.id+'>'+
        '<div class="thumbnail gallery-single">'+
        '<img src="./pics/'+row.id+'/'+row.name+'" alt="...">'+
        '<div class="caption">'+
        '<h5>'+row.username+'</h5>'+
        '<p><span class="label label-'+getColor(row.tag)+'">'+row.tag+'</span>  </p>'+
        '</div></div>'+
        '</div>');
        // $("#tag-view").show();
        $("#gallery").append(newImage);
        $(newImage).on('click', function() {
          // console.log($(this).parent());
          var tag = $(this).find(".label").html();
          var username = $(this).find("h5").html();
          var iid = $(this).data("iid");
          var name = $(this).find("img").attr("src");
          $("#singleView").text('<div class="col-xs-12 '+tag.replace(' ','-') +' '+username.replace(' ','-')+'" data-iid='+iid+'>'+
          '<div class="thumbnail gallery-single">'+
          '<img src="'+name+'" alt="...">'+
          '<div class="caption">'+
          '<h5>'+username+'</h5>'+
          '<p><span class="label label-'+getColor(tag)+'">'+tag+'</span>  </p>'+
          '<p>'+row.dd+'</span>  </p>'+
          '</div></div>'+
          '</div>');
          $("#singlePicPop").modal("show");
        });

      });
    }, '#error');
  });
});



// UI Actions
function viewListener() {

  $("#tag-view-button").on('click', function() {
    $("#tag-view").show();
    $("#tag-view-button").find(".badge").first().text("-");
    $("#name-view").hide();
    $("#name-view-button").find(".badge").first().text("+");
  });
  $("#name-view-button").on('click', function() {
    $("#tag-view").hide();
    $("#tag-view-button").find(".badge").first().text("+");
    $("#name-view").show();
    $("#name-view-button").find(".badge").first().text("-");
  });

// console.log($(".views"));
  $(".views").find("li").on('click', function(){
    var eleVar = $(this).find("cu").html();
    eleVar = eleVar.replace(' ', '-');
    var displayEles = $("#gallery").find("."+eleVar);
    // console.log(displayEles);
    $("#gallery").find(".col-xs-4").hide();
    $(displayEles).show();
  });

}

// Load all images
function loadImages(){
  $("#gallery").empty();
  restGet(HOST+"/images", GET_METHOD, function(data){
    $.each(data, function(index,row) {
      // console.log(row);
      var tag = (row.tag).replace(' ', '-')
      var username = (row.username).replace(' ', '-')
      var newImage = $('<div class="col-xs-4 '+tag +' '+username+'" data-iid='+row.id+'>'+
      '<div class="thumbnail gallery-single">'+
      '<img src="./pics/'+row.id+'/'+row.name+'" alt="...">'+
      '<div class="caption">'+
      '<h5>'+row.username+'</h5>'+
      '<p><span class="label label-'+getColor(row.tag)+'">'+row.tag+'</span>  </p>'+
      '<p>'+row.dd+'</span>  </p>'+
      '</div></div>'+
      '</div>');
      // $("#tag-view").show();
      $("#gallery").append(newImage);
      $(newImage).on('click', function() {
        // console.log($(this).parent());
        var tag = $(this).find(".label").html();
        var username = $(this).find("h5").html();
        var iid = $(this).data("iid");
        var name = $(this).find("img").attr("src");
        $("#singleView").empty().append('<div class="col-xs-12 '+tag.replace(' ','-') +' '+username.replace(' ','-')+'" data-iid='+iid+'>'+
        '<div class="thumbnail gallery-single">'+
        '<img src="'+name+'" alt="...">'+
        '<div class="caption">'+
        '<h5>'+username+'</h5>'+
        '<p><span class="label label-'+getColor(tag)+'">'+tag+'</span>  </p>'+
        '</div></div>'+
        '</div>');
        restGet(HOST+"/comments/"+iid, GET_METHOD, function(data){
          $("#comments").empty();
          $.each(data, function(index, row){
            appendNote(row);
          });
        }, "#error");
        $("#singlePicPop").modal("show");
      });

    });
  }, '#error');
}

// return Tag color by tag length
function getColor(tag){
  len = tag.length;
  if(len>6){
    len = len%6
  }
  var color = ["primary", "default", "success", "info", "warning", "danger"];
  return color[len-1];
}

// Load all users
function loadNames() {
  restGet(HOST+"/users", GET_METHOD, function(data){
    $.each(data, function(index,row) {
      // console.log($("#name-view"));
      // console.log(row.username);
      $("#name-view").append('<li class="list-item"><cu>'+row.username+'</cu> <span class="badge">'+row.count+'</span></li>');
      // $("#tag-view").show();
      viewListener();
    });
  }, '#error');
}
// Load All tags
function loadTags() {
  restGet(HOST+"/tags", GET_METHOD, function(data){
    $.each(data, function(index,row) {
      // console.log($("#tag-view"));
      // console.log(row.tag);
      $("#tag-view").append('<li class="list-item"><cu>'+row.tag+'</cu> <span class="badge">'+row.count+'</span></li>');
      // $("#tag-view").show();
      viewListener();
    });
  }, '#error');
}

// Load top 10 users who upload the most
function loadTopNames() {
  restGet(HOST+"/topusers", GET_METHOD, function(data){
    // console.log(data);
    $.each(data, function(index,row) {
      // console.log($("#tag-view"));
      // console.log(row.tag);
      // console.log($("#top-users"));
      // console.log(row.username);
      $("#top-users").append('<li class="list-item"><cu>'+row.username+'</cu> <span class="badge">'+row.count+'</span></li>');

      // $("#tag-view").show();
      viewListener();
    });
  }, '#error');
}

// Load top 10 tags which used most frequently
function loadTopTags() {
  restGet(HOST+"/toptags", GET_METHOD, function(data){
    $.each(data, function(index,row) {
      // console.log($("#tag-view"));
      // console.log(row.tag);
      $("#top-tags").append('<li class="list-item"><cu>'+row.tag+'</cu> <span class="badge">'+row.count+'</span></li>');
      // $("#tag-view").show();
      viewListener();
    });
  }, '#error');
}


  //UI Function: Add new note
  function newComment(){
    var note = {};
    $("#info").empty();
    note.username = $("#username-comment").val();
    if(note.username.length<1){
      $("#info").empty().append("<li>Your name can not be empty</li>");
      return false;
    }
    note.content = $("#newNote").val();
    note.iid = $("#singleView").find(".col-xs-12").data("iid");
    restSet(HOST+"/comments", POST_METHOD, note, function(){
      console.log("Comments Success");
      cleanComment();
      $("#singlePicPop").modal("hide");
    },'#error');

  }
  //Empty comments input
  function cleanComment() {
    $("#username-comment").val("");
    $("#tag-comment").val("");
    $("#newNote").val("");
  }

  //UI Function: Append note to UI
  function appendNote(note) {
    $("#comments").append(
      '<div class="note">'+
      '<div class="note-title">'+
      '<i>Comment By: '+note.username+'</i>'+
      '</div>'+
      '<div class="note-content">'+ note.comments +
      '</div></div>');
  }

  </script>

</html>
